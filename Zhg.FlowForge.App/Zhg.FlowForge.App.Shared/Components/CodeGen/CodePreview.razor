<!-- Components/CodeGen/CodePreview.razor -->
@using Zhg.FlowForge.App.Shared.Components.Display
@using Zhg.FlowForge.App.Shared.Services

<div class="space-y-3">
    @if (Files != null && Files.Any())
    {
        @foreach (var file in Files)
        {
            <Card>
                <div class="mb-3 flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <i class="@GetFileIcon(file.Path) text-sm"></i>
                        <span class="text-sm font-medium text-slate-900">@file.Path</span>
                    </div>
                    <Badge Variant="info" Size="sm">@file.LineCount 行</Badge>
                </div>

                <pre class="scrollable max-h-96 overflow-auto rounded-lg bg-slate-900 p-4 text-xs text-slate-300"><code>@file.Content</code></pre>
            </Card>
        }
    }
    else
    {
        <div class="flex flex-col items-center justify-center py-12">
            <i class="fas fa-file-code mb-3 text-4xl text-slate-300"></i>
            <p class="text-sm text-slate-600">暂无预览内容</p>
        </div>
    }
</div>

@code {
    [Parameter] public List<GeneratedFile> Files { get; set; } = new();

    private string GetFileIcon(string path)
    {
        var ext = System.IO.Path.GetExtension(path).ToLower();
        return ext switch
        {
            ".cs" => "fas fa-file-code text-blue-400",
            ".csproj" => "fas fa-project-diagram text-green-400",
            ".json" => "fas fa-brackets-curly text-amber-400",
            _ => "fas fa-file text-slate-400"
        };
    }
}